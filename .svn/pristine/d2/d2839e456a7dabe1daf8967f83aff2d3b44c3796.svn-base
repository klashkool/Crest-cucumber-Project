package com.Utils;

import java.io.File;
import java.util.HashMap;
import java.util.List;

import org.junit.Assert;
import org.openqa.selenium.By;

public class testexcelreport_val extends Base {

	public static void testexcel(List<HashMap<String, String>> data) throws InterruptedException {

		log.info("Creating a New PO");
		driver.findElement(By.linkText("PROCUREMENT")).click();
		driver.findElement(By.linkText("Purchase Order")).click();
		driver.findElement(By.linkText("Reports")).click();
		driver.findElement(By.linkText("Purchase Order Excel")).click();
		driver.findElement(By.name("minDate_i18n")).sendKeys("04/03/2020");
		driver.findElement(By.name("maxDate_i18n")).sendKeys("04/03/2020");
		driver.findElement(By.name("supplierPartyId")).sendKeys("125550");

		driver.findElement(By.xpath("//*[@id='purchaseOrderSubmit']/td/input")).click();

		Thread.sleep(2000);

		FileRename.test();

		List<HashMap<String, String>> PO_Report = ExcelReader_ReportsVal.readExcelDatafromFile("C:\\Users\\KailashR\\Downloads\\report.xls",
						"purchase_order_report");

		Thread.sleep(5000);
		int counter = 0;
		for (int a = 2; a < PO_Report.size() - 1; a++) {

			if (PO_Report.get(a).get("P.O. No.").equals(data.get(14).get("Supplier"))) {
				counter++;
			}
		}
		System.out.println(counter);
		Assert.assertEquals(10, counter);
		File file = new File("C:\\Users\\KailashR\\Downloads\\report.xls");

		if (file.delete()) {
			System.out.println("file deleted");

		}

	}
}